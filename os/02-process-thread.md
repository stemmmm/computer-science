# 프로세스와 쓰레드

## 프로세스

### 프로세스에 대해 설명하세요.
- 정의: 메모리에 올라가 실행 중인 프로그램
- 독립적인 메모리 공간(코드, 데이터, 힙 스택)을 가지며 운영체제에 의해 관리됨

<br>

### 프로세스 메모리 공간에 대해 설명하세요.
- 프로세스의 메모리 공간은 코드, 데이터, 힙, 스택으로 이루어짐
- 코드: 실행할 프로그램의 기계어가 저장되는 영역(read-only)
- 데이터: 전역 변수와 static 변수들이 저장되는 영역(read-write)
    - 초기화된 데이터 영역: 초기화된 데이터가 저장되는 영역
    - Block Started by Symbol(BSS): 초기화되지 않은 데이터가 저장되는 영역(0이나 null로 초기화)
- 힙: 런타임에 동적으로 할당되는 영역
- 스택: 함수 스택 프레임 및 지역 변수 저장을 위한 영역
    
#### 스택과 힙 영역의 크기는 어떻게 결정되나요?
- 스택: 프로세스 생성 시 결정, 결정된 크기보다 많은 메모리를 사용하려하면 스택 오버플로우 발생
- 힙: 런타임에 동적으로 할당 및 해제됨

#### 스택과 힙 중 속도가 더 빠른 공간과 그 이유를 설명하세요.
- 스택이 훨씬 더 빠름
- 메모리 관리: 스택 포인터를 더하고 빼는, 즉 스택 프레임을 push/pop 하는 간단한 방식으로 이루어지므로 오버헤드 적음
- 연속적 할당: 스택 프레임은 메모리에 연속적으로 할당되므로 접근 속도가 매우 빠르며, 캐시 hit rate가 높음
  - 반면 힙은 불연속적으로 할당되고, 메모리 관리 방식이 복잡(GC)하므로 스택에 비해 매우 느림

<br>

### 프로세스의 종류에 대해 설명하세요.
- 포그라운드 프로세스: 사용자와 직접 상호작용하는 프로세스
- 백그라운드 프로세스: 사용자와 상호작용하지 않고 실행되는 프로세스
    - e.g. 데몬(daemon): 시스템 서비스나 관리 작업을 수행하는 프로세스
    
#### 포그라운드 프로세스가 백그라운드 프로세스로 전환될 수 있나요? 혹은 그 반대로도 전환될 수 있나요?
- 사용자가 직접 전환하거나, 자원의 효율적인 사용을 위해 시스템이 자동으로 전환할 수 있음

<br>

### Process Control Block(PCB)에 대해 설명하세요.
- 정의: 각 프로세스에 대한 정보를 저장하고 관리하는 데 사용되는 자료구조
- 주요 구성 요소: PID, 프로세스 상태, 레지스터 값(PC 값 등), 스케줄링 정보 …
    
#### PCB는 메모리에 어떻게 저장되고 관리되나요?
- PCB는 운영체제 커널 영역의 프로세스 테이블에 저장됨
- 프로세스 테이블은 각 프로세스에 대한 PCB를 리스트 형태로 관리함

<br>

### Inter-Process Communication(IPC)에 대해 설명하세요.
- 정의: 서로 다른 프로세스간 데이터를 주고받기 위한 방식
- 프로세스들은 서로 독립적인 메모리 공간을 가진채로 실행되므로 IPC가 아니면 직접적인 데이터 공유가 불가능함
    
#### IPC의 종류에는 어떤 것들이 있나요?
1. 파이프: 여러 프로세스가 공통적으로 사용하는 임시 파일
    1. Anonymous Pipe
        1. 단방향 통신 지원(한 프로세스는 파이프에 쓰기만하고 다른 프로세스는 파이프에서 읽기만 함)
        2. 부모-자식 프로세스 간의 통신에서만 사용 가능(이유: https://blog.naver.com/akj61300/80130589983)
    2. Named Pipe
        1. 서로 다른 프로세스 간의 양방향 통신 지원
        2. 이름이 붙어있어 파일 시스탬 내에서 파일처럼 취급됨
2. 메시지 큐: 프로세스 간 메시지를 비동기적으로 주고받기 위한 큐
3. Shared Memory: 여러 프로세스가 동일한 메모리 공간에 접근해 데이터 공유
4. Memory Map: 파일을 메모리 주소에 매핑해 파일의 내용을 메모리처럼 접근 → 여러 프로세스가 동일한 파일을 매핑해 데이터 공유
5. Socket: 네트워크를 통한 IPC 지원, 원격 시스템의 프로세스와 통신 가능
6. Semaphore, Mutex, Monitor: 프로세스간 동기화 문제 해결을 위해 사용

<br>

## 쓰레드

### 쓰레드에 대해 설명하세요.
- 정의: 프로세스를 구성하는 실행 흐름 단위
- 멀티쓰레드: 하나의 프로세스 내에서 여러 쓰레드가 실행될 수 있음
- 쓰레드는 같은 프로세스 내의 다른 쓰레드와 프로세스 자원(코드, 데이터, 힙 영역)을 공유함
- 쓰레드는 자신만의 PC, 스택, 레지스터 값을 가짐

<br>

### Thread Control Block(TCB)에 대해 설명하세요.
- 정의: 각 쓰레드에 대한 정보를 저장하고 관리하는 데 사용되는 자료구조
- 주요 구성 요소: PC, 쓰레드 상태, 스택 포인터, 레지스터 값, 우선순위 …

<br>

## 프로세스 vs 쓰레드

### 하나의 프로그램은 반드시 하나의 프로세스로 실행되어야 하나요?
- 하나의 프로그램이 반드시 하나의 프로세스로 실행되어야 할 필요는 없음
- 구글 크롬의 경우, 각 탭이 별도의 프로세스로 실행되므로 하나의 탭에서 문제가 발생해도 다른 탭에는 영향을 미치지 않음

<br>

### 컨텍스트 스위칭에 대해 설명하세요.
- 정의: 프로세스 또는 쓰레드 간 CPU 제어권을 전환하는 과정
- 이유
    - 각 프로세스나 쓰레드는 CPU를 한정된 시간 동안만 점유할 수 있음
    - 우선순위가 더 높은 프로세스나 쓰레드가 실행돼야 할 수 있음
    - 따라서 프로세스나 쓰레드간 전환은 필연적임

<br>

### 프로세스와 쓰레드의 장단점은 무엇이며, 언제 어떤 것을 사용하는 것이 적절할까요?
- 프로세스
    - 장점: 독립적인 메모리 공간 사용 → 독립성, 안정성
    - 단점: 메모리 오버헤드, 컨텍스트 스위칭 오버헤드, 통신(IPC) 오버헤드
    - 사용: 성능보다 자원의 안정성과 보안이 중요한 경우 사용
- 쓰레드
    - 장점: 프로세스의 자원 공유 → 메모리, 컨텍스트 스위칭, 통신 오버헤드 상대적으로 적음
    - 단점: 하나의 쓰레드에서 문제가 발생하면 다른 쓰레드에 영향을 미칠 수 있음, 동기화 문제
    - 사용: 자원 공유와 성능이 중요한 경우 사용

#### 프로세스와 쓰레드의 컨텍스트 스위칭 과정은 어떻게 다른가요?
- 프로세스
    1. 현재 프로세스 상태 저장: 현재 프로세스의 컨텍스트(메모리 맵 포함)를 PCB에 저장 
    2. 새 프로세스 상태 복구: 새로 실행될 프로세스의 PCB를 읽어 컨텍스트(메모리 맵 포함) 복구
    3. 새 프로세스 실행
- 쓰레드
    1. 현재 쓰레드 상태 저장: 현재 쓰레드의 컨텍스트를 TCB에 저장
    2. 새 쓰레드 상태 복구: 새로 실행될 쓰레드의 TCB를 읽어 상태 복구
    3. 새 쓰레드 실행
- 차이점 정리
    - 프로세스 간의 컨텍스트 스위칭은 프로세스의 메모리 관련 정보까지 관리해야 하므로 오버헤드가 심함
    - 쓰레드 간의 컨텍스트 스위칭은 같은 프로세스 내 즉, 같은 메모리 영역 내에서 발생하므로 메모리 맵이 변경되지 않아 오버헤드가 적음
